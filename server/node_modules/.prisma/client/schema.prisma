// prisma/schema.prisma - Prisma schema for RM, ProductPlan, Formula

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model RM {
  code           String          @id
  name           String? // optional เพื่อรองรับการ import ข้อมูลเก่า
  g_total        Float?
  order          Int? // <--- เพิ่มบรรทัดนี้
  formulas       Formula[]
  productPlanRMs ProductPlanRM[]
}

model ProductPlan {
  id         Int             @id @default(autoincrement())
  colorCode  String
  lot        String
  percent    Float
  date       DateTime
  department String
  rms        ProductPlanRM[]
}

model ProductPlanRM {
  id            Int         @id @default(autoincrement())
  productPlan   ProductPlan @relation(fields: [productPlanId], references: [id])
  productPlanId Int
  rm            RM          @relation(fields: [rmCode], references: [code])
  rmCode        String
  qtyUsed       Float
}

model Formula {
  id           Int    @id @default(autoincrement())
  colorCode    String
  chemicalCode String
  qtyPerLot    Float?
  chemical     RM?    @relation(fields: [chemicalCode], references: [code])
}
